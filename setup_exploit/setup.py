from sqlalchemy import create_engine
from os import listdir
from os.path import isfile, join

user = 'test'
host = 'localhost'
password = '1234'
database = 'test'
link_path = 'foods'
image_path = 'images'

engine = create_engine("mysql://" + user + ":" + password + "@" + host + "/" + database)
conn = engine.connect()

try:
	conn.execute("CREATE TABLE foods (id INT(12) UNSIGNED AUTO_INCREMENT PRIMARY KEY, \
									link VARCHAR(128) NOT NULL UNIQUE, \
									img VARCHAR(128) NOT NULL UNIQUE)")

	conn.execute("CREATE TABLE users (id INT(12) UNSIGNED AUTO_INCREMENT PRIMARY KEY, \
									username VARCHAR(128) NOT NULL UNIQUE, \
									nickname VARCHAR(128) NOT NULL, \
									password VARCHAR(128) NOT NULL, \
									role VARCHAR(128) NOT NULL, \
									suffix VARCHAR(128) NOT NULL)")
except Exception:
	print '[+] Tables created'

link = sorted([f for f in listdir(link_path) if isfile(join(link_path, f))])
image = sorted([f for f in listdir(image_path) if isfile(join(image_path, f)) and f != 'maxresdefault_live.jpg'])

try:
	for item in zip(link, image):
		conn.execute('INSERT INTO foods(link, img) VALUES("foods/' + item[0] + '","images/' + item[1] + '")');
except Exception:
	print '[+] Data inserted'

print '[+] Done'